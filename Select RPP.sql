case when ftcm.first_trans <  DATEADD(DAY, -356, '20181230') then 52
when ftcm.first_trans between DATEADD(DAY, -356, '20181230') and DATEADD(DAY, -350, '20181230') then 51
when ftcm.first_trans between DATEADD(DAY, -349, '20181230') and DATEADD(DAY, -343, '20181230') then 50
when ftcm.first_trans between DATEADD(DAY, -342, '20181230') and DATEADD(DAY, -336, '20181230') then 49
when ftcm.first_trans between DATEADD(DAY, -335, '20181230') and DATEADD(DAY, -329, '20181230') then 48
when ftcm.first_trans between DATEADD(DAY, -328, '20181230') and DATEADD(DAY, -322, '20181230') then 47
when ftcm.first_trans between DATEADD(DAY, -321, '20181230') and DATEADD(DAY, -315, '20181230') then 46
when ftcm.first_trans between DATEADD(DAY, -314, '20181230') and DATEADD(DAY, -308, '20181230') then 45
when ftcm.first_trans between DATEADD(DAY, -307, '20181230') and DATEADD(DAY, -301, '20181230') then 44
when ftcm.first_trans between DATEADD(DAY, -300, '20181230') and DATEADD(DAY, -294, '20181230') then 43
when ftcm.first_trans between DATEADD(DAY, -293, '20181230') and DATEADD(DAY, -287, '20181230') then 42
when ftcm.first_trans between DATEADD(DAY, -286, '20181230') and DATEADD(DAY, -280, '20181230') then 41
when ftcm.first_trans between DATEADD(DAY, -279, '20181230') and DATEADD(DAY, -273, '20181230') then 40
when ftcm.first_trans between DATEADD(DAY, -272, '20181230') and DATEADD(DAY, -266, '20181230') then 39
when ftcm.first_trans between DATEADD(DAY, -265, '20181230') and DATEADD(DAY, -259, '20181230') then 38
when ftcm.first_trans between DATEADD(DAY, -258, '20181230') and DATEADD(DAY, -252, '20181230') then 37
when ftcm.first_trans between DATEADD(DAY, -251, '20181230') and DATEADD(DAY, -245, '20181230') then 36
when ftcm.first_trans between DATEADD(DAY, -244, '20181230') and DATEADD(DAY, -238, '20181230') then 35
when ftcm.first_trans between DATEADD(DAY, -237, '20181230') and DATEADD(DAY, -231, '20181230') then 34
when ftcm.first_trans between DATEADD(DAY, -230, '20181230') and DATEADD(DAY, -224, '20181230') then 33
when ftcm.first_trans between DATEADD(DAY, -223, '20181230') and DATEADD(DAY, -217, '20181230') then 32
when ftcm.first_trans between DATEADD(DAY, -216, '20181230') and DATEADD(DAY, -210, '20181230') then 31
when ftcm.first_trans between DATEADD(DAY, -209, '20181230') and DATEADD(DAY, -203, '20181230') then 30
when ftcm.first_trans between DATEADD(DAY, -202, '20181230') and DATEADD(DAY, -196, '20181230') then 29
when ftcm.first_trans between DATEADD(DAY, -195, '20181230') and DATEADD(DAY, -189, '20181230') then 28
when ftcm.first_trans between DATEADD(DAY, -188, '20181230') and DATEADD(DAY, -182, '20181230') then 27
when ftcm.first_trans between DATEADD(DAY, -181, '20181230') and DATEADD(DAY, -175, '20181230') then 26
when ftcm.first_trans between DATEADD(DAY, -174, '20181230') and DATEADD(DAY, -168, '20181230') then 25
when ftcm.first_trans between DATEADD(DAY, -167, '20181230') and DATEADD(DAY, -161, '20181230') then 24
when ftcm.first_trans between DATEADD(DAY, -160, '20181230') and DATEADD(DAY, -154, '20181230') then 23
when ftcm.first_trans between DATEADD(DAY, -153, '20181230') and DATEADD(DAY, -147, '20181230') then 22
when ftcm.first_trans between DATEADD(DAY, -146, '20181230') and DATEADD(DAY, -140, '20181230') then 21
when ftcm.first_trans between DATEADD(DAY, -139, '20181230') and DATEADD(DAY, -133, '20181230') then 20
when ftcm.first_trans between DATEADD(DAY, -132, '20181230') and DATEADD(DAY, -126, '20181230') then 19
when ftcm.first_trans between DATEADD(DAY, -125, '20181230') and DATEADD(DAY, -119, '20181230') then 18
when ftcm.first_trans between DATEADD(DAY, -118, '20181230') and DATEADD(DAY, -112, '20181230') then 17
when ftcm.first_trans between DATEADD(DAY, -111, '20181230') and DATEADD(DAY, -105, '20181230') then 16
when ftcm.first_trans between DATEADD(DAY, -104, '20181230') and DATEADD(DAY,  -98, '20181230') then 15
when ftcm.first_trans between DATEADD(DAY,  -97, '20181230') and DATEADD(DAY,  -91, '20181230') then 14
when ftcm.first_trans between DATEADD(DAY,  -90, '20181230') and DATEADD(DAY,  -84, '20181230') then 13
when ftcm.first_trans between DATEADD(DAY,  -83, '20181230') and DATEADD(DAY,  -77, '20181230') then 12
when ftcm.first_trans between DATEADD(DAY,  -76, '20181230') and DATEADD(DAY,  -70, '20181230') then 11
when ftcm.first_trans between DATEADD(DAY,  -69, '20181230') and DATEADD(DAY,  -63, '20181230') then 10
when ftcm.first_trans between DATEADD(DAY,  -62, '20181230') and DATEADD(DAY,  -56, '20181230') then 9
when ftcm.first_trans between DATEADD(DAY,  -55, '20181230') and DATEADD(DAY,  -49, '20181230') then 8
when ftcm.first_trans between DATEADD(DAY,  -48, '20181230') and DATEADD(DAY,  -42, '20181230') then 7
when ftcm.first_trans between DATEADD(DAY,  -41, '20181230') and DATEADD(DAY,  -35, '20181230') then 6
when ftcm.first_trans between DATEADD(DAY,  -34, '20181230') and DATEADD(DAY,  -28, '20181230') then 5
when ftcm.first_trans between DATEADD(DAY,  -27, '20181230') and DATEADD(DAY,  -21, '20181230') then 4
when ftcm.first_trans between DATEADD(DAY,  -20, '20181230') and DATEADD(DAY,  -14, '20181230') then 3
when ftcm.first_trans between DATEADD(DAY,  -13, '20181230') and DATEADD(DAY,   -7, '20181230') then 2
when ftcm.first_trans > 	  DATEADD(DAY,   -7, '20181230') then 1
end pembagi_RPP_2018,

case when ftcm.first_trans <  DATEADD(DAY, -209, '20181230') then 52
when ftcm.first_trans between DATEADD(DAY, -209, '20181230') and DATEADD(DAY, -203, '20181230') then 30
when ftcm.first_trans between DATEADD(DAY, -202, '20181230') and DATEADD(DAY, -196, '20181230') then 29
when ftcm.first_trans between DATEADD(DAY, -195, '20181230') and DATEADD(DAY, -189, '20181230') then 28
when ftcm.first_trans between DATEADD(DAY, -188, '20181230') and DATEADD(DAY, -182, '20181230') then 27
when ftcm.first_trans between DATEADD(DAY, -181, '20181230') and DATEADD(DAY, -175, '20181230') then 26
when ftcm.first_trans between DATEADD(DAY, -174, '20181230') and DATEADD(DAY, -168, '20181230') then 25
when ftcm.first_trans between DATEADD(DAY, -167, '20181230') and DATEADD(DAY, -161, '20181230') then 24
when ftcm.first_trans between DATEADD(DAY, -160, '20181230') and DATEADD(DAY, -154, '20181230') then 23
when ftcm.first_trans between DATEADD(DAY, -153, '20181230') and DATEADD(DAY, -147, '20181230') then 22
when ftcm.first_trans between DATEADD(DAY, -146, '20181230') and DATEADD(DAY, -140, '20181230') then 21
when ftcm.first_trans between DATEADD(DAY, -139, '20181230') and DATEADD(DAY, -133, '20181230') then 20
when ftcm.first_trans between DATEADD(DAY, -132, '20181230') and DATEADD(DAY, -126, '20181230') then 19
when ftcm.first_trans between DATEADD(DAY, -125, '20181230') and DATEADD(DAY, -119, '20181230') then 18
when ftcm.first_trans between DATEADD(DAY, -118, '20181230') and DATEADD(DAY, -112, '20181230') then 17
when ftcm.first_trans between DATEADD(DAY, -111, '20181230') and DATEADD(DAY, -105, '20181230') then 16
when ftcm.first_trans between DATEADD(DAY, -104, '20181230') and DATEADD(DAY,  -98, '20181230') then 15
when ftcm.first_trans between DATEADD(DAY,  -97, '20181230') and DATEADD(DAY,  -91, '20181230') then 14
when ftcm.first_trans between DATEADD(DAY,  -90, '20181230') and DATEADD(DAY,  -84, '20181230') then 13
when ftcm.first_trans between DATEADD(DAY,  -83, '20181230') and DATEADD(DAY,  -77, '20181230') then 12
when ftcm.first_trans between DATEADD(DAY,  -76, '20181230') and DATEADD(DAY,  -70, '20181230') then 11
when ftcm.first_trans between DATEADD(DAY,  -69, '20181230') and DATEADD(DAY,  -63, '20181230') then 10
when ftcm.first_trans between DATEADD(DAY,  -62, '20181230') and DATEADD(DAY,  -56, '20181230') then 9
when ftcm.first_trans between DATEADD(DAY,  -55, '20181230') and DATEADD(DAY,  -49, '20181230') then 8
when ftcm.first_trans between DATEADD(DAY,  -48, '20181230') and DATEADD(DAY,  -42, '20181230') then 7
when ftcm.first_trans between DATEADD(DAY,  -41, '20181230') and DATEADD(DAY,  -35, '20181230') then 6
when ftcm.first_trans between DATEADD(DAY,  -34, '20181230') and DATEADD(DAY,  -28, '20181230') then 5
when ftcm.first_trans between DATEADD(DAY,  -27, '20181230') and DATEADD(DAY,  -21, '20181230') then 4
when ftcm.first_trans between DATEADD(DAY,  -20, '20181230') and DATEADD(DAY,  -14, '20181230') then 3
when ftcm.first_trans between DATEADD(DAY,  -13, '20181230') and DATEADD(DAY,   -7, '20181230') then 2
when ftcm.first_trans > 	  DATEADD(DAY,   -7, '20181230') then 1
end pembagi_YTD_2018,

case when ftcm.first_trans < DATEADD(DAY, -83, '20190811') then 13
when ftcm.first_trans between DATEADD(DAY, -83, '20190811') and DATEADD(DAY, -77, '20190811') then 12
when ftcm.first_trans between DATEADD(DAY, -76, '20190811') and DATEADD(DAY, -70, '20190811') then 11
when ftcm.first_trans between DATEADD(DAY, -69, '20190811') and DATEADD(DAY, -63, '20190811') then 10
when ftcm.first_trans between DATEADD(DAY, -62, '20190811') and DATEADD(DAY, -56, '20190811') then 9
when ftcm.first_trans between DATEADD(DAY, -55, '20190811') and DATEADD(DAY, -49, '20190811') then 8
when ftcm.first_trans between DATEADD(DAY, -48, '20190811') and DATEADD(DAY, -42, '20190811') then 7
when ftcm.first_trans between DATEADD(DAY, -41, '20190811') and DATEADD(DAY, -35, '20190811') then 6
when ftcm.first_trans between DATEADD(DAY, -34, '20190811') and DATEADD(DAY, -28, '20190811') then 5
when ftcm.first_trans between DATEADD(DAY, -27, '20190811') and DATEADD(DAY, -21, '20190811') then 4
when ftcm.first_trans between DATEADD(DAY, -20, '20190811') and DATEADD(DAY, -14, '20190811') then 3
when ftcm.first_trans between DATEADD(DAY, -13, '20190811') and DATEADD(DAY, -7 , '20190811') then 2
when ftcm.first_trans > DATEADD(DAY, -7, '20190811') then 1
end